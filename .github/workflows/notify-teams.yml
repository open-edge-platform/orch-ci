# SPDX-FileCopyrightText: (C) 2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0
---
name: Notify Teams

on:
  workflow_call:
    secrets:
      MSTEAMS_WEBHOOK:
        required: true
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Microsoft Teams
        uses: skitionek/notify-microsoft-teams@11e40c38c3a629ae65a985b582eca4897b01e79e
        if: always()
        with:
          webhook_url: ${{ secrets.MSTEAMS_WEBHOOK }}
          raw: >-
            {
              "@type": "MessageCard",
              "@context": "http://schema.org/extensions",
              "title": "Failure on ${{ github.repository }}",
              "summary": "Failure on ${{ github.workflow }}",
              "sections": [
                {
                  "activityTitle": "Failure on ${{ github.workflow }}",
                  "activitySubtitle": "",
                  "activityImage": "https://raw.githubusercontent.com/Skitionek/notify-microsoft-teams/master/icons/failure.png"
                }
              ],
              "potentialAction": [
                {
                  "@type": "OpenUri",
                  "name": "Go to failure",
                  "targets": [
                    {
                      "os": "default",
                      "uri": "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
                    }
                  ]
                }
              ]
            }
          job: '{}'
          steps: '{}'
          needs: '{}'
